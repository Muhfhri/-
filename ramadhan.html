<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ramadhan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dark-mode.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link href="css/nav.css" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
    <script src="js/webver.js"></script>
    <!-- AOS PLUGIN -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri+Quran&display=swap');

        body {
            font-family: 'Amiri Quran', serif;
        }

        h1, h3 {
            font-family: 'Amiri Quran', serif;
        }

        .text-muted {
            font-family: 'Google Sans Mono', monospace !important;
        }

        span {
            font-size: 1.5rem;
            text-align: center;
        }

        #surah-arab {
            font-size: 1.9em;
            line-height: 2.5em;
        }

        #surah-translation {
            font-size: 1.2em;
            line-height: 1.5em;
        }

        .col-md-4 {
            font-size: 1.3rem;
        }
    </style>
</head>

<body>
    <div class="container text-center mt-2 ">
        <img id="light" alt="" width="200px">
        <br><input type="checkbox" class="btn-check" id="darkSwitch" checked autocomplete="off">
        <label class="btn btn-dark btn-sm rounded-5" for="darkSwitch"><iconify-icon
                id="darkmode"></iconify-icon></label>
    </div>
    <div class="container text-center mt-2">
        <h1>Info Ramadhan</h1>
        <div class="container mt-2 text-center">
            <div class="row">
                <div class="col-md-4">
                    <p id="ramadhan-counter"></p>
                </div>
                <div class="col-md-4">
                    <p id="prayer-schedule"></p>
                </div>
                <div class="col-md-4">
                    <p id="countdown"></p>
                </div>
            </div>
        </div>
    </div>
    <div class="container text-center">
        <h3>Surah Hari Ini:</h3>
        <p id="surah-arab" class="quran"><img id="light" alt="" width="150px"></p>
        <p id="surah-translation"></p>
        <p id="surah-source"></p>
    </div>
    <div class="container text-center">
        <h3>Pengingat:</h3>
        <span id="maaf"></span>
        <br>
        <!-- <a href="index" class="btn btn-outline-dark rounded-5 manrope">Kembali</a> -->
        <br><small class="text-muted">Open Source - v1.0.4, API by <a href="https://alquran.cloud/" class="link-none">Quran Cloud</a>. You can fork this project as you want, don't forget to give credit to me.</small>
    </div>
    <div class="container">
        
    </div>
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
    <script>
        var typed = new Typed("#maaf", {
            strings: [
    'Semoga kita semua diberikan kesehatan dan keberkahan di bulan Ramadhan ini',
    'Perbanyak membaca Al-Quran di bulan Ramadhan',
    
    'Jangan lupa untuk berdoa dan memohon ampunan kepada Allah SWT di bulan yang spesial ini',
    'Jangan lupa untuk bersedekah kepada yang membutuhkan',
    'Hindari perbuatan yang dapat membatalkan puasa',
    'Tingkatkan ibadah malam seperti shalat tarawih',
    'Shalat tarawih memberikan pahala besar dan menghapus dosa-dosa',
    'Bersedekah di bulan Ramadhan dapat melipatgandakan pahala',
    'Menahan amarah dan emosi adalah bagian dari kesempurnaan puasa',
    'Puasa bukan hanya menahan lapar dan haus, tapi juga menjaga hati dan lisan',
    'Memakan dan minum dengan sengaja akan membatalkan puasa',
    'Berkata kasar dan berbohong dapat mengurangi pahala puasa, jadi berhati hatilah!',
    'Membantu sesama di bulan Ramadhan membawa keberkahan hidup',
    'Zakat fitrah membersihkan harta dan menyempurnakan ibadah puasa',
    'Lailatul Qadar adalah malam yang lebih baik dari seribu bulan',
    'Berpuasa dengan penuh keikhlasan akan mendapatkan pahala yang berlipat',
    'Menggunjing atau bergosip bisa mengurangi pahala puasa',
    'Sabar dan ikhlas dalam menjalankan puasa membawa ketenangan jiwa',
    'Sahur adalah sunnah yang penuh berkah, jangan sampai terlewat!',
    'Berbuka dengan yang manis bisa mengembalikan energi tubuh lebih cepat',
    'Menjaga wudhu sepanjang hari membantu menjaga kesucian diri',
    'Berdoa saat berbuka puasa adalah waktu yang mustajab',
    'Menolong orang berbuka puasa mendapatkan pahala seperti orang yang berpuasa',
    'Puasa mengajarkan kita arti syukur dan kepedulian terhadap sesama'
],
            typeSpeed: 30,
            backSpeed: 25,
            backDelay: 1400,
            startDelay: 500,
            loop: true,
            cursorChar: '|',
            smartBackspace: false,
            shuffle: true,
            fadeOut: true,
            fadeOutClass: 'typed-fade-out',
            fadeOutDelay: 900,
            onComplete: (self) => {
            self.cursor.remove();
            }
        });
    </script>

<script>
// Tanggal awal Ramadhan
const ramadhanStart = new Date(2025, 2, 1); // 1 Maret 2025
const today = new Date();
const timeDiff = ramadhanStart - today;
const dayDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));

let message = "";
if (dayDiff > 0) {
    message = `Ramadhan akan dimulai dalam ${dayDiff} hari lagi.`;
} else {
    const ramadhanDay = Math.abs(dayDiff) + 1;
    message = `Memasuki hari ke-${ramadhanDay} Ramadhan.`;
}
document.getElementById("ramadhan-counter").textContent = message;

// Jadwal salat selama Ramadhan (Subuh & Maghrib)
const prayerTimes = [
    { day: 1, subuh: "04:42", maghrib: "18:14" },
    { day: 2, subuh: "04:42", maghrib: "18:14" },
    { day: 3, subuh: "04:42", maghrib: "18:14" },
    { day: 4, subuh: "04:42", maghrib: "18:13" },
    { day: 5, subuh: "04:42", maghrib: "18:13" },
    { day: 6, subuh: "04:42", maghrib: "18:12" },
    { day: 7, subuh: "04:42", maghrib: "18:12" },
    { day: 8, subuh: "04:42", maghrib: "18:12" },
    { day: 24, subuh: "04:42", maghrib: "18:11" },
    { day: 25, subuh: "04:42", maghrib: "18:11" }
    // Tambahkan sisa hari...
];

function getPrayerTimes(day) {
    const defaultTimes = { subuh: "04:30", maghrib: "18:15" };
    const times = prayerTimes.find(pt => pt.day === day);
    return times || defaultTimes;
}

const currentPrayerTimes = getPrayerTimes(Math.abs(dayDiff) + 1);
document.getElementById("prayer-schedule").textContent = `Subuh ${currentPrayerTimes.subuh} | Maghrib ${currentPrayerTimes.maghrib}`;

function updateCountdown() {
    const now = new Date();
    const currentHour = now.getHours();
    const currentMinute = now.getMinutes();

    let nextPrayer = "";
    let prayerTime = "";
    let prayerMessage = "";

    // Ambil waktu Subuh dan Maghrib
    const [subuhHour, subuhMin] = currentPrayerTimes.subuh.split(":").map(Number);
    const [maghribHour, maghribMin] = currentPrayerTimes.maghrib.split(":").map(Number);

    // Hitung waktu imsak (10 menit sebelum Subuh)
    const imsakHour = subuhHour;
    const imsakMin = subuhMin - 10;
    
    // Buat objek Date untuk perbandingan waktu
    const subuhTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), subuhHour, subuhMin, 0);
    const maghribTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), maghribHour, maghribMin, 0);
    const imsakTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), imsakHour, imsakMin, 0);

    // Tentukan salat berikutnya berdasarkan waktu saat ini
    if (now >= maghribTime) {
        nextPrayer = "Subuh";
        prayerTime = currentPrayerTimes.subuh;
    } else if (now >= subuhTime) {
        nextPrayer = "Maghrib";
        prayerTime = currentPrayerTimes.maghrib;
    } else {
        nextPrayer = "Subuh";
        prayerTime = currentPrayerTimes.subuh;
    }

    // Hitung selisih waktu
    const [prayerHour, prayerMin] = prayerTime.split(":").map(Number);
    const prayerDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), prayerHour, prayerMin, 0);

    if (now > prayerDate) {
        prayerDate.setDate(prayerDate.getDate() + 1); // Ambil jadwal besok
    }

    const timeLeft = prayerDate - now;
    const hours = Math.floor((timeLeft / (1000 * 60 * 60)) % 24);
    const minutes = Math.floor((timeLeft / (1000 * 60)) % 60);
    const seconds = Math.floor((timeLeft / 1000) % 60);

    // Pesan peringatan khusus
    if (now.getHours() === maghribHour && now.getMinutes() === maghribMin) {
        prayerMessage = "Waktu Berbuka!";
    } else if (now.getHours() === subuhHour && now.getMinutes() === subuhMin) {
        prayerMessage = "Waktu Sahur Selesai!";
    } else if (now >= imsakTime && now < subuhTime) {
        prayerMessage = "Memasuki waktu imsak, menuju Subuh...";
    } else {
        prayerMessage = `Menuju ${nextPrayer}: ${hours} jam ${minutes} menit ${seconds} detik`;
    }

    document.getElementById("countdown").textContent = prayerMessage;
}

// Jalankan setiap detik untuk memperbarui tampilan
setInterval(updateCountdown, 1000);
updateCountdown();

    </script>

    <script>
        async function getSurah() {
            try {
                const response = await fetch("https://api.alquran.cloud/v1/surah");
                const data = await response.json();

                console.log(data); // Tambahkan log untuk memeriksa struktur data

                if (data.data && data.data.length > 0) {
                    const randomIndex = Math.floor(Math.random() * data.data.length);
                    const surah = data.data[randomIndex];

                    // Ambil semua ayat dari surah yang dipilih
                    const ayahResponse = await fetch(`https://api.alquran.cloud/v1/surah/${surah.number}`);
                    const ayahData = await ayahResponse.json();

                    console.log(ayahData); // Tambahkan log untuk memeriksa struktur data ayah

                    if (ayahData.data && ayahData.data.ayahs.length > 0) {
                        // Acak urutan ayat
                        const randomAyahIndex = Math.floor(Math.random() * ayahData.data.ayahs.length);
                        const ayah = ayahData.data.ayahs[randomAyahIndex];

                        const arabicText = `<p>${formatSupElements(ayah.text)}</p>`;

                        // Ambil terjemahan dalam bahasa Indonesia
                        const translationResponse = await fetch(`https://api.quran.com/api/v4/quran/translations/33?verse_key=${surah.number}:${ayah.numberInSurah}`);
                        const translationData = await translationResponse.json();

                        console.log(translationData); // Tambahkan log untuk memeriksa struktur data terjemahan

                        let translationText = "Terjemahan tidak tersedia";
                        if (translationData.translations && translationData.translations.length > 0) {
                            translationText = `<p>${ayah.numberInSurah}. ${translationData.translations[0].text}</p>`;
                        }

                        document.getElementById("surah-arab").innerHTML = arabicText;
                        document.getElementById("surah-translation").innerHTML = translationText;
                        document.getElementById("surah-source").textContent = `Surah ${surah.englishName} (${surah.number}), Ayat ${ayah.numberInSurah}`;
                    } else {
                        document.getElementById("surah-arab").textContent = "Ayat tidak ditemukan.";
                    }
                } else {
                    document.getElementById("surah-arab").textContent = "Surah tidak ditemukan.";
                }
            } catch (error) {
                console.error("Error mengambil surah:", error);
                document.getElementById("surah-arab").textContent = "Gagal memuat surah.";
            }
        }

        function formatSupElements(text) {
            return text.replace(/<sup[^>]*foot_note[^>]*>(.*?)<\/sup>/g, '<sup>$1</sup>');
        }

        getSurah();
    </script>

    <script src="js/dark-mode-switch.js"></script>
</body>

</html>